% hamaker 
clear all;
sigma = 1;
epsilon = 1;
A = 100;
h = 0.1:0.01:1;
a_1 = 5;
a_2 = 0.5;
a= 5;
r = (a_1+a_2) + h;
U_a = - A/6 *( 2*a_1*a_2./(r.^2 - ( a_1+ a_2).^2)+ ...
               2*a_1*a_2./(r.^2)+...%  - ( a_1- a_2).^2)+ ...
               log((r.^2 - ( a_1+ a_2).^2)./(r.^2)));%- ( a_1- a_2).^2)) );

           
U_r =  A/37800 * sigma.^6./r.* (...
            (r.^2 -14*r*a + 54*a.^2)./(r-2*a).^7 ...
           +(r.^2 +14*r*a+54*a.^2)./(r+2*a).^7 ...
           -2*(r.^2-30*a.^2)/(r.^7));




% U_r = A/37800 * sigma.^6./r.* (...
%               (r.^2 - 7.*r .*(a_1+a_2)+ 6*(a_1.^2+7*a_1*a_2+a_2.^2))./ ...
%               ((r-a_1-a_2).^7)...
%               + (r.^2 + 7.*r .*(a_1+a_2)+ 6*(a_1.^2+7*a_1*a_2+a_2.^2))./ ...
%               ((r+a_1-a_2).^7)...
%               -(r.^2 - 7.*r .*(a_1-a_2)+ 6*(a_1.^2-7*a_1*a_2+a_2.^2))./ ...
%               ((r+a_1-a_2).^7)...
%               -(r.^2 - 7.*r .*(a_1-a_2)+ 6*(a_1.^2-7*a_1*a_2+a_2.^2))./ ...
%               ((r-a_1+a_2).^7)...
%               );          
   
U = U_a + U_r;

%plot(r,U)
axis([a_1+a_2+0.1 a_1+a_2+4 -100 100])


%% Point and sphere
eps=1;
sig=1;
A_cs = 100*eps;
a=5;
r=5.5:0.001:8.5;
U_cs = (a*A_cs*a.^3*sig.^3)./(9*(a.^2-r.^2).^3).* ...
    ( 1 - ((5*a.^6+45*a.^4*r.^2+63*a.^2*r.^4+15*r.^6)*sig.^6)./ ...
       ( 15*(a-r).^6.*(a+r).^6));
   
plot(r,U_cs);
axis([5 5+2.5+1 -30 10])
title('hamaker')
% 
% clear all
% x = 0.1:0.01:0.581 ;
% epsilon = 100.0; 
% sigma = 1.0; 
% %pot93 = 2*epsilon * ( 2/15 * (sigma./x) .^9 - (sigma./x).^3);
% pot126= 4*epsilon * ((sigma./x) .^12 - (sigma./x).^6);
% %plot(x, pot93)
% hold on 
% plot(x, pot126)
% 
% legend('hamaker','126')